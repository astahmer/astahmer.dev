---
import ProjectCard from '@/components/ProjectCard.astro'
import SocialLinks from '@/components/SocialLinks.astro'
import Link from '@/components/shared/Link.astro'
import Layout from '@/layouts/Layout.astro'

import { presentation } from '@/data/presentation'
import { projects } from '@/data/projects'
import { css } from '#/styled-system/css'

function convertAsteriskToStrongTag(str: string) {
  return str
    .replace(/\*{1,2}(.*?)\*{1,2}/g, `<strong class="${css({ color: 'sky.300' })}">$1</strong>`)
    .replace('\n', '<br />')
}
---

<Layout>
  <main class={css({ display: 'flex', flexDir: 'column', gap: '12' })}>
    <article
      class={css({
        display: 'flex',
        flexDir: 'column',
        gap: '8',
        md: { flexDir: 'row-reverse', justifyContent: 'flex-end', gap: '12' },
      })}
    >
      {
        presentation.profile && (
          <img src={presentation.profile} class={css({ w: '1/4', alignSelf: 'center', rounded: 'full' })} />
        )
      }

      <div class={css({ display: 'flex', flexDir: 'column', gap: '8' })}>
        <h1 class={css({ textStyle: '3xl', color: 'neutral.100' })}>
          {presentation.title}
        </h1>

        <h2
          class={css({ w: 'auto', maxW: '60ch', lineHeight: 'normal' })}
          set:html={convertAsteriskToStrongTag(presentation.description)}
        />

        <SocialLinks />
      </div>
    </article>

    <article class={css({ display: 'flex', flexDir: 'column', gap: '8' })}>
      <header class={css({ display: 'flex', w: 'full', flexDir: 'row', justifyContent: 'space-between', gap: '2' })}>
        <h3 class={css({ textStyle: 'lg', color: 'neutral.100' })}>Featured projects</h3>
      </header>
      {projects.length === 0 && <p>Oops, I must work^^^^^</p>}

      <section class={css({ display: 'flex', flexDir: 'column', gap: '4' })}>
        {projects.length !== 0 && projects.map((project) => <ProjectCard {...project} />)}
      </section>
    </article>

    <article class={css({ display: 'flex', flexDir: 'column', gap: '8' })}>
      <header class={css({ display: 'flex', w: 'full', flexDir: 'row', justifyContent: 'space-between', gap: '2' })}>
        <h3 class={css({ textStyle: 'lg', color: 'neutral.100' })}>Get in touch</h3>
      </header>
      <p>
        Email me at <Link href={`mailto:${presentation.mail}`} label={presentation.mail} /> or DM me using my social
        links.
      </p>

      <SocialLinks />
    </article>
  </main>
</Layout>
